!function(){"use strict";var t=angular.module("tChat",["ui.bootstrap"]);t.run(["ThreadService",function(t){var e,a;e=[{name:"Tom"},{name:"Dick"},{name:"Harry"}],a=[{name:"Classroom"}],t.openThread("direct",[e[0]]),t.openThread("multi",[e[1],e[2]]),t.openThread("group",[a[0]])}])}(),angular.module("tChat").directive("tChatThreads",["ThreadService",function(t){"use strict";function e(e){e.threads=t.getOpenedThreads}return{restrict:"A",replace:!0,scope:{},templateUrl:"/src/partials/t-chat-threads.html",link:e}}]),angular.module("tChat").directive("tChatThread",[function(){"use strict";return{restrict:"A",replace:!0,scope:{thread:"="},templateUrl:"/src/partials/t-chat-thread.html",controller:"ThreadController"}}]),angular.module("tChat").directive("tChatWidget",function(){"use strict";return{restrict:"A",replace:!0,scope:{title:"@"},templateUrl:"/src/partials/t-chat-widget.html"}}),angular.module("tChat").controller("ThreadController",["$scope","$log","ThreadService",function(t,e,a){"use strict";t.ui={minimized:0,highlighted:0,users:[]},t.close=function(){e.log("close thread "+t.thread.tid),a.closeThread(t.thread.tid)},t.mute=function(){},t.addUsers=function(t){t=t||[]},t.getMessages=function(t,e){e=e||25},t.removeUser=function(){},t.$on("$destroy",function(){e.log("thread "+t.thread.tid+" has been destroyed")})}]),angular.module("tChat").controller("UserListController",["$scope","ThreadService",function(t,e){"use strict";t.data={search:""},t.users=[{uid:1,name:"Administrator"},{uid:2,name:"Alan Turing"}],t.chat=function(t){e.openThread("direct",[t])}}]),angular.module("tChat").controller("GroupListController",["$scope","ThreadService",function(t,e){"use strict";t.data={search:""},t.groups=[{uid:1,name:"Physics Class"},{uid:2,name:"English Class"}],t.chat=function(t){e.openThread("group",[t])}}]),angular.module("tChat").controller("ThreadArchiveController",["$scope",function(t){"use strict";t.threads=[{tid:1,title:"Physics Class",lastMessage:"Bye guys"},{tid:2,title:"Ravi, Barack",lastMessage:"See you. Lets catch up sometime."}]}]),angular.module("tChat").filter("reverse",function(){"use strict";return function(t){return t.slice().reverse()}}),angular.module("tChat").factory("ThreadService",["$log",function(t){"use strict";function e(){return"temp."+ ++c}function a(){return u}function n(t){return t.name}function r(e){return 1===e.length?n(e[0]):2===e.length?_.str.sprintf("%s, %s & you",e[0].name,e[1].name):e.length>2?_.str.sprintf("%s, %s, you & %d others",e[0].name,e[1].name,e.length-1):(t.warn("multi-user thread has "+e.length+" users."),"")}function i(t){return t.name}function s(t,a){var n={tid:e(),title:l(t,a),type:t,_state:"open"};switch(t){case"direct":case"multi":n.users=a;break;case"group":n.group=a[0];break;default:throw new Error("thread has unknown type: "+t)}return n}function l(t,e){if(!e.length)throw new Error("need at least one entity.");switch(t){case"direct":return n(e[0]);case"multi":return r(e);case"group":return i(e[0]);default:throw new Error("thread has unknown type: "+t)}}function d(t,e){u.push(s(t,e))}function o(e){u=_.filter(u,function(t){return t.tid!==e}),t.log(u.length+" threads remain")}var c=0,u=[];return{openThread:d,closeThread:o,getOpenedThreads:a}}]),angular.module("tChat").run(["$templateCache",function(t){t.put("/src/partials/t-chat-thread.html",'<div class="col-xs-4 panel-thread-container" data-ng-class="{\n    \'panel-container-minimized\': ui.minimized == 1\n  }">\n  <div class="panel panel-thread panel-thread-{{ thread.type }} panel-default" data-ng-class="{\n      \'panel-success\': ui.highlighted,\n    }" data-tid="{{ thread.tid }}">\n    <div class="panel-heading">\n      <div class="panel-heading-buttons pull-right">\n        <div class="btn-group" data-dropdown>\n          <button type="button" class="btn btn-xs btn-default btn-actions dropdown-toggle" id="t-chat-thread-settings-{{ thread.tid }}" \n          data-toggle="dropdown">\n            <i class="fa fa-cog"></i>\n          </button>\n          <ul class="dropdown-menu" role="menu" aria-labelledby="t-chat-thread-settings-{{ thread.tid }}">\n            <li role="presentation">\n              <a role="menuitem" tabindex="-1" href="#">\n                <i class="fa fa-user"></i> Add more people\n              </a>\n            </li>\n            <li role="presentation" data-ng-if="thread.type === \'multi\'">\n              <a role="menuitem" tabindex="-1" href="#">\n                <i class="fa fa-power-off"></i> Leave\n              </a>\n            </li>\n          </ul>\n          <button type="button" class="btn btn-xs btn-default btn-resize" \n            data-ng-click="ui.minimized = !ui.minimized">\n            <i class="fa" data-ng-class="{ \n              \'fa-minus\': ui.minimized == 0,\n              \'fa-plus\': ui.minimized == 1 }">\n            </i>\n          </button>\n          <button type="button" class="btn btn-xs btn-default btn-close" data-ng-click="close()">\n            <i class="fa fa-remove"></i>\n          </button>\n        </div>\n      </div>  \n      <div class="panel-title" data-ng-if="thread.title">\n        {{ thread.title }} <span class="badge badge-danger"> 2 </span>\n      </div>\n    </div>\n    <div class="panel-content" data-ng-show="!ui.minimized">\n      <div class="panel-body"></div>\n      <div class="panel-footer">\n        <input type="text" class="form-control" name="chat" placeholder="Send a message.">\n      </div>\n    </div>\n  </div>\n</div>'),t.put("/src/partials/t-chat-threads.html",'<div class="col-xs-8">\n  <div class="container-threads row">\n    <div data-t-chat-thread\n         data-ng-repeat="t in threads() | reverse | limitTo:3 track by t.tid "\n         data-thread="t"\n         data-tid="{{ t.tid }}">\n    </div>\n  </div>\n</div>'),t.put("/src/partials/t-chat-widget.html",'<div class="col-xs-4 panel-chat-widget-container">\n  <div class="panel panel-default panel-chat-widget">\n    <div class="panel-heading">\n      <div class="panel-title">\n        Teamie Chat\n      </div>\n    </div>\n    <div class="panel-body">\n      <tabset>\n        <tab ng-controller="UserListController">\n          <tab-heading><i class="glyphicon glyphicon-user"></i>&nbsp;&nbsp;People</tab-heading>\n          <div class="search-user-container input-group">\n            <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>\n            <input type="search" class="form-control input-sm search-user" placeholder="Eg. John Doe" \n            ng-model="data.search"/>\n          </div>\n          <div class="list-people list-group">\n            <a href="" ng-click="chat(user)" ng-repeat="user in users | filter:data.search" class="list-group-item" \n            data-uid="{{ user.uid }}">\n              {{ user.name }}\n            </a>\n          </div>\n        </tab>\n        <tab ng-controller="GroupListController">\n          <tab-heading><i class="fa fa-list-alt"></i>&nbsp;&nbsp;Groups</tab-heading>\n          <div class="input-group search-group-container">\n            <div class="input-group-addon"><i class="fa fa-search"></i></div>\n            <input type="search" class="form-control input-sm" placeholder="Eg. Some class" \n            ng-model="data.search"/>\n          </div>\n          <div class="list-user-groups list-group">\n            <a href="" ng-repeat="group in groups | filter:data.search" class="list-group-item" ng-click="chat(group)"\n            data-uid="{{ group.gid }}">\n              {{ group.name }}\n            </a>\n          </div>\n        </tab>\n        <tab ng-controller="ThreadArchiveController">\n          <tab-heading><i class="fa fa-hdd-o"></i>&nbsp;&nbsp;Archive</tab-heading>\n          <div class="list-archived-threads list-group">\n            <a href="" ng-repeat="thread in threads | filter:data.search" class="list-group-item" \n            data-uid="{{ group.gid }}">\n              <h4 class="list-group-item-heading">{{ thread.title }}</h4>\n              <p class="text-muted list-group-item-text">{{ thread.lastMessage }}</p>\n            </a>\n          </div>\n        </tab>\n        <!-- <tab heading="Notifications" ng-controller="NotificationsController"></tab> -->\n      </tabset>\n    </div>\n  </div>\n</div>')}]);